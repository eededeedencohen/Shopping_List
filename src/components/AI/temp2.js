const originalData = {
  "רמי לוי": [
    {
      branchName: "רמי לוי",
      branchAddress: "האומן,15",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "יד חרוצים 18",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18be1",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a43",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b21",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21bfd",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "דרך החורש 90",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18be4",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a46",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "הפרסה 3",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18be7",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a49",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b24",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21c00",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "איזור התעשיה שער בנימין",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18bea",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a4c",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b27",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21c03",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "בית הדפוס 13",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18bed",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a4f",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b2a",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21c06",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "כנפי נשרים 26",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18bf0",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a52",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b2d",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21c09",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "רמי לוי",
      branchAddress: "איזור תעשיה עטרות",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341eac07fd56234a18bf3",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21a55",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21b30",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.9,
            hasDiscount: true,
            discount: {
              units: 6,
              priceForUnit: 3.33,
              totalPrice: 20,
              _id: "67b341ebc07fd56234a21c0c",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
  ],
  "שערי רווחה": [
    {
      branchName: "שערי רווחה",
      branchAddress: "לואיס ברנדס 3",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341eac07fd56234a18bdb",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7149",
            name: "דוריטוס נאצ'ו",
            hasUiqueBarcode: true,
            barcode: "7290100850909",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7149",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21a1f",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21a3d",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21b1b",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21bf7",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
    {
      branchName: "שערי רווחה",
      branchAddress: "25 ירמיהו",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714a",
            name: "דוריטוס חריף אש",
            hasUiqueBarcode: true,
            barcode: "7290010117864",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714a",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341eac07fd56234a18bde",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714d",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290100850916",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714d",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21a40",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f7148",
            name: "דוריטוס גריל",
            hasUiqueBarcode: true,
            barcode: "7290100850923",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f7148",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21b1e",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714b",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290100850930",
            brand: "דוריטוס",
            weight: 70,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714b",
          },
          price: {
            price: 3.5,
            hasDiscount: true,
            discount: {
              units: 3,
              priceForUnit: 3.33,
              totalPrice: 10,
              _id: "67b341ebc07fd56234a21bfa",
            },
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.5,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
  ],
  "שפע ברכת השם": [
    {
      branchName: "שפע ברכת השם",
      branchAddress: "האומן 14",
      products: [
        {
          product: {
            _id: "646db90aadbba146043f714f",
            name: "דוריטוס טבעי",
            hasUiqueBarcode: true,
            barcode: "7290106528628",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714f",
          },
          price: {
            price: 8.6,
            hasDiscount: false,
            discount: null,
          },
        },
        {
          product: {
            _id: "646db90aadbba146043f714e",
            name: "דוריטוס חמוץ חריף",
            hasUiqueBarcode: true,
            barcode: "7290106667266",
            brand: "דוריטוס",
            weight: 185,
            unitWeight: "g",
            generalName: "דוריטוס",
            __v: 0,
            category: "חטיפים ודגנים",
            subcategory: "חטיפים מלוחים",
            id: "646db90aadbba146043f714e",
          },
          price: {
            price: 8.6,
            hasDiscount: false,
            discount: null,
          },
        },
      ],
    },
  ],
};

/** מחזיר חתימה ייחודית למחיר בפועל (מתעלם משדות לא-רלוונטיים כמו _id) */
function priceSignature(price) {
  if (!price.hasDiscount) {
    // מחיר רגיל: "REG-3.9"
    return `REG-${price.price}`;
  }
  // מבצע כמותי: "DISC-3.9-6-20"
  const d = price.discount;
  return `DISC-${price.price}-${d.units}-${d.totalPrice}`;
}

/* ----------  דחיסה ענפית ---------- */

/**
 * דוחס אוסף סניפים של רשת אחת:
 * @returns Object   { barcode → {price, branches[]} | [{price, branches[]}, …] }
 */
function groupByBarcode(branches) {
  const byBarcode = {}; // barcode → sig → { price, branches[] }

  for (const { branchAddress, products } of branches) {
    for (const { product, price } of products) {
      const bc = product.barcode;
      const sig = priceSignature(price);

      if (!byBarcode[bc]) byBarcode[bc] = {};
      if (!byBarcode[bc][sig]) byBarcode[bc][sig] = { price, branches: [] };

      byBarcode[bc][sig].branches.push(branchAddress);
    }
  }

  // אם לברקוד יש רק מחיר אחד – הפוך לאובייקט יחיד; אחרת השאר כ-array
  const out = {};
  for (const [bc, sigMap] of Object.entries(byBarcode)) {
    const list = Object.values(sigMap); // [{price, branches}]
    out[bc] = list.length === 1 ? list[0] : list;
  }
  return out;
}

/* ----------  דחיסת כל הרשתות ---------- */

/**
 * @param {Object} data — מבנה המקור { רשת → מערך סניפים }
 * @returns {Object}     { רשת → מבנה דחוס לפי ברקוד }
 */
function compressNetworks(data) {
  const result = {};
  for (const [chainName, branches] of Object.entries(data)) {
    result[chainName] = groupByBarcode(branches);
  }
  return result;
}

/* ----------  דוגמת שימוש ---------- */

const compressed = compressNetworks(originalData);
// console.log(JSON.stringify(compressed, null, 2));

function prettyPrint(compressed) {
  const fmtDiscount = (p) => {
    if (!p.hasDiscount) return "ללא הנחה";
    const { units, totalPrice } = p.discount;
    return `הנחה ${units}-ב-${totalPrice} ₪`;
  };

  for (const [chain, barcodes] of Object.entries(compressed)) {
    console.log(`\n=== ${chain} ===`);
    for (const [barcode, entry] of Object.entries(barcodes)) {
      const groups = Array.isArray(entry) ? entry : [entry];
      groups.forEach(({ price, branches }) => {
        const branchesStr = branches.join(", ");
        console.log(
          `  • ${barcode} – ${price.price} ₪  [${fmtDiscount(
            price
          )}]  ← ${branchesStr}`
        );
      });
    }
  }
}

prettyPrint(compressed);
